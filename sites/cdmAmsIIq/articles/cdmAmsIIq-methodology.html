<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMS-II.Q Methodology Walkthrough â€¢ cdmAmsIIq</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="AMS-II.Q Methodology Walkthrough">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cdmAmsIIq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cdmAmsIIq-methodology.html">AMS-II.Q Methodology Walkthrough</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>AMS-II.Q Methodology Walkthrough</h1>
            
      

      <div class="hidden name"><code>cdmAmsIIq-methodology.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to reproduce the AMS-II.Q calculations
using <code>cdmAmsIIq</code>. The methodology covers commercial building
projects that combine energy efficiency upgrades with onsite energy
supply. The workflow quantifies baseline emissions, splits project
emissions between grid consumption and onsite energy, incorporates
leakage, and reports net emission reductions and energy intensity
diagnostics.</p>
</div>
<div class="section level2">
<h2 id="applicability-checks">Applicability Checks<a class="anchor" aria-label="anchor" href="#applicability-checks"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">cdmAmsIIq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">baseline_services</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  service <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cooling"</span>, <span class="st">"lighting"</span><span class="op">)</span>,</span>
<span>  baseline_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">project_services</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  service <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cooling"</span>, <span class="st">"lighting"</span><span class="op">)</span>,</span>
<span>  project_units <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">monitoring_snapshot</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  baseline_energy_use_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">820</span>, <span class="fl">610</span><span class="op">)</span>,</span>
<span>  baseline_emission_factor_tco2_per_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.62</span>, <span class="fl">0.61</span><span class="op">)</span>,</span>
<span>  project_energy_use_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">540</span>, <span class="fl">430</span><span class="op">)</span>,</span>
<span>  project_emission_factor_tco2_per_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.58</span>, <span class="fl">0.57</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">baseline_intensity</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  building_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span>,</span>
<span>  baseline_energy_use_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">820</span>, <span class="fl">610</span><span class="op">)</span>,</span>
<span>  baseline_service_output_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">760</span>, <span class="fl">540</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">project_intensity</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  building_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span>,</span>
<span>  project_energy_use_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">540</span>, <span class="fl">430</span><span class="op">)</span>,</span>
<span>  project_service_output_mwh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">760</span>, <span class="fl">540</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/applicability_iiq.html">check_applicability_service_scope_iiq</a></span><span class="op">(</span><span class="va">baseline_services</span>, <span class="va">project_services</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/applicability_iiq.html">check_applicability_monitoring_iiq</a></span><span class="op">(</span><span class="va">monitoring_snapshot</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/applicability_iiq.html">check_applicability_efficiency_gain_iiq</a></span><span class="op">(</span></span>
<span>  <span class="va">baseline_intensity</span>,</span>
<span>  <span class="va">project_intensity</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span>,</span>
<span>  minimum_improvement <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="simulated-dataset">Simulated Dataset<a class="anchor" aria-label="anchor" href="#simulated-dataset"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_ams_iiq_inputs.html">simulate_ams_iiq_inputs</a></span><span class="op">(</span>n_buildings <span class="op">=</span> <span class="fl">3</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu">quiet_kable</span><span class="op">(</span><span class="va">inputs</span><span class="op">$</span><span class="va">baseline_data</span>, format <span class="op">=</span> <span class="st">"html"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">## Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">## See help("Deprecated")</span></span></code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
building_id
</th>
<th style="text-align:right;">
baseline_energy_use_mwh
</th>
<th style="text-align:right;">
baseline_emission_factor_tco2_per_mwh
</th>
<th style="text-align:right;">
baseline_service_output_mwh
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
B1
</td>
<td style="text-align:right;">
735.28
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
579.41
</td>
</tr>
<tr>
<td style="text-align:left;">
B2
</td>
<td style="text-align:right;">
789.48
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
804.74
</td>
</tr>
<tr>
<td style="text-align:left;">
B3
</td>
<td style="text-align:right;">
807.73
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
634.04
</td>
</tr>
</tbody>
</table>
<p>The simulation provides baseline, project, and leakage datasets for
each building, including energy use, emission factors, service output,
onsite energy, and leakage placeholders.</p>
</div>
<div class="section level2">
<h2 id="equation-walkthrough">Equation Walkthrough<a class="anchor" aria-label="anchor" href="#equation-walkthrough"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baseline_emissions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_baseline_building_emissions_iiq.html">calculate_baseline_building_emissions_iiq</a></span><span class="op">(</span></span>
<span>  <span class="va">inputs</span><span class="op">$</span><span class="va">baseline_data</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">project_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_project_building_emissions_iiq.html">calculate_project_building_emissions_iiq</a></span><span class="op">(</span></span>
<span>  <span class="va">inputs</span><span class="op">$</span><span class="va">project_data</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">project_onsite</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_project_onsite_energy_emissions_iiq.html">calculate_project_onsite_energy_emissions_iiq</a></span><span class="op">(</span></span>
<span>  <span class="va">inputs</span><span class="op">$</span><span class="va">project_data</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">project_totals</span> <span class="op">&lt;-</span> <span class="va">project_grid</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_onsite</span>, by <span class="op">=</span> <span class="st">"building_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    project_emissions_tco2e <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html" class="external-link">coalesce</a></span><span class="op">(</span><span class="va">project_emissions_tco2e</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html" class="external-link">coalesce</a></span><span class="op">(</span><span class="va">project_onsite_emissions_tco2e</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">leakage_totals</span> <span class="op">&lt;-</span> <span class="va">inputs</span><span class="op">$</span><span class="va">leakage_data</span></span>
<span></span>
<span><span class="va">emission_reductions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_emission_reductions_iiq.html">calculate_emission_reductions_iiq</a></span><span class="op">(</span></span>
<span>  baseline_emissions <span class="op">=</span> <span class="va">baseline_emissions</span>,</span>
<span>  project_emissions <span class="op">=</span> <span class="va">project_totals</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">building_id</span>, <span class="va">project_emissions_tco2e</span><span class="op">)</span>,</span>
<span>  leakage_emissions <span class="op">=</span> <span class="va">leakage_totals</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">walkthrough_results</span> <span class="op">&lt;-</span> <span class="va">baseline_emissions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_totals</span>, by <span class="op">=</span> <span class="st">"building_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">leakage_totals</span>, by <span class="op">=</span> <span class="st">"building_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">emission_reductions</span>, by <span class="op">=</span> <span class="st">"building_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">quiet_kable</span><span class="op">(</span><span class="va">walkthrough_results</span>, format <span class="op">=</span> <span class="st">"html"</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">## Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">## See help("Deprecated")</span></span></code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
building_id
</th>
<th style="text-align:right;">
baseline_emissions_tco2e
</th>
<th style="text-align:right;">
baseline_energy_intensity
</th>
<th style="text-align:right;">
project_emissions_tco2e
</th>
<th style="text-align:right;">
project_energy_intensity
</th>
<th style="text-align:right;">
project_onsite_emissions_tco2e
</th>
<th style="text-align:right;">
leakage_emissions_tco2e
</th>
<th style="text-align:right;">
emission_reductions_tco2e
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
B1
</td>
<td style="text-align:right;">
453.323
</td>
<td style="text-align:right;">
1.269
</td>
<td style="text-align:right;">
254.608
</td>
<td style="text-align:right;">
0.791
</td>
<td style="text-align:right;">
4.134
</td>
<td style="text-align:right;">
0.164
</td>
<td style="text-align:right;">
198.551
</td>
</tr>
<tr>
<td style="text-align:left;">
B2
</td>
<td style="text-align:right;">
518.332
</td>
<td style="text-align:right;">
0.981
</td>
<td style="text-align:right;">
324.716
</td>
<td style="text-align:right;">
0.672
</td>
<td style="text-align:right;">
2.380
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
193.518
</td>
</tr>
<tr>
<td style="text-align:left;">
B3
</td>
<td style="text-align:right;">
497.780
</td>
<td style="text-align:right;">
1.274
</td>
<td style="text-align:right;">
365.934
</td>
<td style="text-align:right;">
0.971
</td>
<td style="text-align:right;">
2.113
</td>
<td style="text-align:right;">
0.077
</td>
<td style="text-align:right;">
131.770
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="monitoring-period-aggregation">Monitoring Period Aggregation<a class="anchor" aria-label="anchor" href="#monitoring-period-aggregation"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">monitoring_summary</span> <span class="op">&lt;-</span> <span class="va">inputs</span><span class="op">$</span><span class="va">baseline_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">inputs</span><span class="op">$</span><span class="va">project_data</span>, by <span class="op">=</span> <span class="st">"building_id"</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_baseline"</span>, <span class="st">"_project"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">inputs</span><span class="op">$</span><span class="va">leakage_data</span>, by <span class="op">=</span> <span class="st">"building_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">quiet_kable</span><span class="op">(</span><span class="va">monitoring_summary</span>, format <span class="op">=</span> <span class="st">"html"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">## Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">## See help("Deprecated")</span></span></code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
building_id
</th>
<th style="text-align:right;">
baseline_energy_use_mwh
</th>
<th style="text-align:right;">
baseline_emission_factor_tco2_per_mwh
</th>
<th style="text-align:right;">
baseline_service_output_mwh
</th>
<th style="text-align:right;">
project_energy_use_mwh
</th>
<th style="text-align:right;">
project_emission_factor_tco2_per_mwh
</th>
<th style="text-align:right;">
project_service_output_mwh
</th>
<th style="text-align:right;">
project_onsite_energy_gj
</th>
<th style="text-align:right;">
project_onsite_emission_factor_tco2_per_gj
</th>
<th style="text-align:right;">
leakage_emissions_tco2e
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
B1
</td>
<td style="text-align:right;">
735.28
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
579.41
</td>
<td style="text-align:right;">
458.55
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
579.41
</td>
<td style="text-align:right;">
74.64
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
B2
</td>
<td style="text-align:right;">
789.48
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
804.74
</td>
<td style="text-align:right;">
540.51
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
804.74
</td>
<td style="text-align:right;">
43.58
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
B3
</td>
<td style="text-align:right;">
807.73
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
634.04
</td>
<td style="text-align:right;">
615.43
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
634.04
</td>
<td style="text-align:right;">
35.27
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="meta-function">Meta-Function<a class="anchor" aria-label="anchor" href="#meta-function"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimate_emission_reductions_ams_iiq.html">estimate_emission_reductions_ams_iiq</a></span><span class="op">(</span></span>
<span>  baseline_data <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">baseline_data</span>,</span>
<span>  project_data <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">project_data</span>,</span>
<span>  leakage_data <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">leakage_data</span>,</span>
<span>  group_cols <span class="op">=</span> <span class="st">"building_id"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 Ã— 9</span></span></span>
<span><span class="co">##   building_id baseline_emissions_tco2e baseline_energy_intensity</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> B1                              453.                     1.27 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> B2                              518.                     0.981</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> B3                              498.                     1.27 </span></span>
<span><span class="co">## <span style="color: #949494;"># â„¹ 6 more variables: project_grid_emissions_tco2e &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   project_energy_intensity &lt;dbl&gt;, project_onsite_emissions_tco2e &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   project_emissions_tco2e &lt;dbl&gt;, leakage_emissions_tco2e &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   emission_reductions_tco2e &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="function-reference">Function Reference<a class="anchor" aria-label="anchor" href="#function-reference"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">function_reference</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Function <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"`calculate_baseline_building_emissions_iiq()`"</span>,</span>
<span>    <span class="st">"`calculate_project_building_emissions_iiq()`"</span>,</span>
<span>    <span class="st">"`calculate_project_onsite_energy_emissions_iiq()`"</span>,</span>
<span>    <span class="st">"`calculate_emission_reductions_iiq()`"</span>,</span>
<span>    <span class="st">"`estimate_emission_reductions_ams_iiq()`"</span>,</span>
<span>    <span class="st">"`simulate_ams_iiq_inputs()`"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Signature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"`calculate_baseline_building_emissions_iiq(baseline_data, energy_consumption_col = \"baseline_energy_use_mwh\", emission_factor_col = \"baseline_emission_factor_tco2_per_mwh\", service_output_col = \"baseline_service_output_mwh\", group_cols = NULL, output_col = \"baseline_emissions_tco2e\", intensity_col = \"baseline_energy_intensity\")`"</span>,</span>
<span>    <span class="st">"`calculate_project_building_emissions_iiq(project_data, energy_consumption_col = \"project_energy_use_mwh\", emission_factor_col = \"project_emission_factor_tco2_per_mwh\", service_output_col = \"project_service_output_mwh\", group_cols = NULL, output_col = \"project_emissions_tco2e\", intensity_col = \"project_energy_intensity\")`"</span>,</span>
<span>    <span class="st">"`calculate_project_onsite_energy_emissions_iiq(project_data, onsite_energy_col = \"project_onsite_energy_gj\", emission_factor_col = \"project_onsite_emission_factor_tco2_per_gj\", group_cols = NULL, output_col = \"project_onsite_emissions_tco2e\")`"</span>,</span>
<span>    <span class="st">"`calculate_emission_reductions_iiq(baseline_emissions, project_emissions, leakage_emissions = NULL, group_cols = NULL, output_col = \"emission_reductions_tco2e\")`"</span>,</span>
<span>    <span class="st">"`estimate_emission_reductions_ams_iiq(baseline_data, project_data, leakage_data = NULL, group_cols = NULL, baseline_energy_consumption_col = \"baseline_energy_use_mwh\", baseline_emission_factor_col = \"baseline_emission_factor_tco2_per_mwh\", baseline_service_output_col = \"baseline_service_output_mwh\", project_energy_consumption_col = \"project_energy_use_mwh\", project_emission_factor_col = \"project_emission_factor_tco2_per_mwh\", project_service_output_col = \"project_service_output_mwh\", project_onsite_energy_col = \"project_onsite_energy_gj\", project_onsite_emission_factor_col = \"project_onsite_emission_factor_tco2_per_gj\", leakage_col = \"leakage_emissions_tco2e\")`"</span>,</span>
<span>    <span class="st">"`simulate_ams_iiq_inputs(n_buildings = 4, seed = NULL)`"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Purpose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Aggregates baseline commercial building energy use into emissions and intensity diagnostics.&lt;br&gt;\\(BE_y = \\sum_i EC^{BL}_{i,y} \\times EF^{BL}_{i,y}\\)"</span>,</span>
<span>    <span class="st">"Summarises post-retrofit grid energy emissions and energy intensity.&lt;br&gt;\\(PE^{grid}_y = \\sum_i EC^{PR}_{i,y} \\times EF^{PR}_{i,y}\\)"</span>,</span>
<span>    <span class="st">"Converts onsite energy supply into project emissions.&lt;br&gt;\\(PE^{onsite}_y = \\sum_i ONS_{i,y} \\times EF^{onsite}_{i,y}\\)"</span>,</span>
<span>    <span class="st">"Combines baseline, project, and leakage emissions to obtain net reductions.&lt;br&gt;\\(ER_y = BE_y - (PE^{grid}_y + PE^{onsite}_y + LE_y)\\)"</span>,</span>
<span>    <span class="st">"Meta-function chaining the AMS-II.Q equation helpers into a tidy workflow.&lt;br&gt;\\(ER_y = BE_y - (PE^{grid}_y + PE^{onsite}_y + LE_y)\\)"</span>,</span>
<span>    <span class="st">"Generates representative baseline, project, and leakage datasets for demonstrations and tests."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">quiet_kable</span><span class="op">(</span><span class="va">function_reference</span>, format <span class="op">=</span> <span class="st">"html"</span>, escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">## Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">## See help("Deprecated")</span></span></code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Signature
</th>
<th style="text-align:left;">
Purpose
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<code><a href="../reference/calculate_baseline_building_emissions_iiq.html">calculate_baseline_building_emissions_iiq()</a></code>
</td>
<td style="text-align:left;">
<code>calculate_baseline_building_emissions_iiq(baseline_data, energy_consumption_col = "baseline_energy_use_mwh", emission_factor_col = "baseline_emission_factor_tco2_per_mwh", service_output_col = "baseline_service_output_mwh", group_cols = NULL, output_col = "baseline_emissions_tco2e", intensity_col = "baseline_energy_intensity")</code>
</td>
<td style="text-align:left;">
Aggregates baseline commercial building energy use into emissions and
intensity
diagnostics.<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>E</mi><mi>y</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mi>i</mi></msub><mi>E</mi><msubsup><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>B</mi><mi>L</mi></mrow></msubsup><mo>Ã—</mo><mi>E</mi><msubsup><mi>F</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>B</mi><mi>L</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">BE_y = \sum_i EC^{BL}_{i,y} \times EF^{BL}_{i,y}</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/calculate_project_building_emissions_iiq.html">calculate_project_building_emissions_iiq()</a></code>
</td>
<td style="text-align:left;">
<code>calculate_project_building_emissions_iiq(project_data, energy_consumption_col = "project_energy_use_mwh", emission_factor_col = "project_emission_factor_tco2_per_mwh", service_output_col = "project_service_output_mwh", group_cols = NULL, output_col = "project_emissions_tco2e", intensity_col = "project_energy_intensity")</code>
</td>
<td style="text-align:left;">
Summarises post-retrofit grid energy emissions and energy
intensity.<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>g</mi><mi>r</mi><mi>i</mi><mi>d</mi></mrow></msubsup><mo>=</mo><msub><mo>âˆ‘</mo><mi>i</mi></msub><mi>E</mi><msubsup><mi>C</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>P</mi><mi>R</mi></mrow></msubsup><mo>Ã—</mo><mi>E</mi><msubsup><mi>F</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>P</mi><mi>R</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">PE^{grid}_y = \sum_i EC^{PR}_{i,y} \times EF^{PR}_{i,y}</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/calculate_project_onsite_energy_emissions_iiq.html">calculate_project_onsite_energy_emissions_iiq()</a></code>
</td>
<td style="text-align:left;">
<code>calculate_project_onsite_energy_emissions_iiq(project_data, onsite_energy_col = "project_onsite_energy_gj", emission_factor_col = "project_onsite_emission_factor_tco2_per_gj", group_cols = NULL, output_col = "project_onsite_emissions_tco2e")</code>
</td>
<td style="text-align:left;">
Converts onsite energy supply into project
emissions.<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>o</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>e</mi></mrow></msubsup><mo>=</mo><msub><mo>âˆ‘</mo><mi>i</mi></msub><mi>O</mi><mi>N</mi><msub><mi>S</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow></msub><mo>Ã—</mo><mi>E</mi><msubsup><mi>F</mi><mrow><mi>i</mi><mo>,</mo><mi>y</mi></mrow><mrow><mi>o</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>e</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">PE^{onsite}_y = \sum_i ONS_{i,y} \times EF^{onsite}_{i,y}</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/calculate_emission_reductions_iiq.html">calculate_emission_reductions_iiq()</a></code>
</td>
<td style="text-align:left;">
<code>calculate_emission_reductions_iiq(baseline_emissions, project_emissions, leakage_emissions = NULL, group_cols = NULL, output_col = "emission_reductions_tco2e")</code>
</td>
<td style="text-align:left;">
Combines baseline, project, and leakage emissions to obtain net
reductions.<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><msub><mi>R</mi><mi>y</mi></msub><mo>=</mo><mi>B</mi><msub><mi>E</mi><mi>y</mi></msub><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>g</mi><mi>r</mi><mi>i</mi><mi>d</mi></mrow></msubsup><mo>+</mo><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>o</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>e</mi></mrow></msubsup><mo>+</mo><mi>L</mi><msub><mi>E</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">ER_y = BE_y - (PE^{grid}_y + PE^{onsite}_y + LE_y)</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/estimate_emission_reductions_ams_iiq.html">estimate_emission_reductions_ams_iiq()</a></code>
</td>
<td style="text-align:left;">
<code>estimate_emission_reductions_ams_iiq(baseline_data, project_data, leakage_data = NULL, group_cols = NULL, baseline_energy_consumption_col = "baseline_energy_use_mwh", baseline_emission_factor_col = "baseline_emission_factor_tco2_per_mwh", baseline_service_output_col = "baseline_service_output_mwh", project_energy_consumption_col = "project_energy_use_mwh", project_emission_factor_col = "project_emission_factor_tco2_per_mwh", project_service_output_col = "project_service_output_mwh", project_onsite_energy_col = "project_onsite_energy_gj", project_onsite_emission_factor_col = "project_onsite_emission_factor_tco2_per_gj", leakage_col = "leakage_emissions_tco2e")</code>
</td>
<td style="text-align:left;">
Meta-function chaining the AMS-II.Q equation helpers into a tidy
workflow.<br><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><msub><mi>R</mi><mi>y</mi></msub><mo>=</mo><mi>B</mi><msub><mi>E</mi><mi>y</mi></msub><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>g</mi><mi>r</mi><mi>i</mi><mi>d</mi></mrow></msubsup><mo>+</mo><mi>P</mi><msubsup><mi>E</mi><mi>y</mi><mrow><mi>o</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>e</mi></mrow></msubsup><mo>+</mo><mi>L</mi><msub><mi>E</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">ER_y = BE_y - (PE^{grid}_y + PE^{onsite}_y + LE_y)</annotation></semantics></math>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code><a href="../reference/simulate_ams_iiq_inputs.html">simulate_ams_iiq_inputs()</a></code>
</td>
<td style="text-align:left;">
<code>simulate_ams_iiq_inputs(n_buildings = 4, seed = NULL)</code>
</td>
<td style="text-align:left;">
Generates representative baseline, project, and leakage datasets for
demonstrations and tests.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="workflow-overview">Workflow Overview<a class="anchor" aria-label="anchor" href="#workflow-overview"></a>
</h2>
<pre><code><span><span class="co">## Warning: 'xfun::attr()' is deprecated.</span></span>
<span><span class="co">## Use 'xfun::attr2()' instead.</span></span>
<span><span class="co">## See help("Deprecated")</span></span></code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Step
</th>
<th style="text-align:left;">
Purpose
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Input baseline, project, and leakage monitoring data
</td>
<td style="text-align:left;">
Collect building-level energy, emission factor, and onsite supply
metrics.
</td>
</tr>
<tr>
<td style="text-align:left;">
calculate_baseline_building_emissions_iiq
</td>
<td style="text-align:left;">
Translate baseline energy use into emissions and intensity diagnostics.
</td>
</tr>
<tr>
<td style="text-align:left;">
calculate_project_building_emissions_iiq
</td>
<td style="text-align:left;">
Summarise project grid energy emissions and efficiency performance.
</td>
</tr>
<tr>
<td style="text-align:left;">
calculate_project_onsite_energy_emissions_iiq
</td>
<td style="text-align:left;">
Account for onsite energy supply emissions within the project boundary.
</td>
</tr>
<tr>
<td style="text-align:left;">
calculate_emission_reductions_iiq
</td>
<td style="text-align:left;">
Subtract project and leakage emissions from baseline totals to obtain
reductions.
</td>
</tr>
<tr>
<td style="text-align:left;">
estimate_emission_reductions_ams_iiq
</td>
<td style="text-align:left;">
Return a tidy tibble with emission reductions and supporting
diagnostics.
</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Christiaan Pauw.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
